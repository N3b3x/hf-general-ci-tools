{% comment %}
  Table of Contents include for Just the Docs theme
  This creates a table of contents from the HTML content
{% endcomment %}

{% assign min_level = include.min_level | default: 2 %}
{% assign max_level = include.max_level | default: 4 %}
{% assign html = include.html | default: content %}

{% comment %} Extract headings from HTML content {% endcomment %}
{% assign headings = html | split: '<h' %}

{% if headings.size > 1 %}
  <ul class="toc-list">
    {% for heading in headings %}
      {% if forloop.first %}
        {% continue %}
      {% endif %}
      
      {% assign heading_parts = heading | split: '>' %}
      {% assign heading_level = heading_parts[0] | plus: 0 %}
      {% assign heading_text = heading_parts[1] | split: '</h' | first | strip_html | strip %}
      {% assign heading_id = heading_text | slugify %}
      
      {% if heading_level >= min_level and heading_level <= max_level %}
        <li class="toc-item toc-level-{{ heading_level }}">
          <a href="#{{ heading_id }}" class="toc-link">{{ heading_text }}</a>
        </li>
      {% endif %}
    {% endfor %}
  </ul>
{% else %}
  <p class="toc-empty">No headings found in this page.</p>
{% endif %}
